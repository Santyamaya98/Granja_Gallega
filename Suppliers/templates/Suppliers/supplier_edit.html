{% extends 'Suppliers/base.html' %}
{% load static %}


{% block head_extra %}
<link rel="stylesheet" href="{% static 'Suppliers/css/supplier_form.css' %}">
{% endblock %}

{% block header %}
<h1>{{ title|default:"Supplier Information" }}</h1>
<p>{% if form.instance.pk %}Update supplier information{% else %}Add new supplier to the network{% endif %}</p>
{% endblock %}

{% block nav %}
<a href="{% url 'supplier_list' %}" class="supplier-link">Back to List</a>
{% if form.instance.pk %}
<a href="{% url 'supplier_detail' form.instance.pk %}" class="supplier-link">View Details</a>
{% endif %}
<a href="#" class="supplier-link">Help</a>
<a href="#" class="supplier-link">Contact</a>
{% endblock %}

{% block content %}
{% if messages %}
    {% for message in messages %}
        <div class="info-box message {{ message.tags }}">
            <p>{{ message }}</p>
        </div>
    {% endfor %}
{% endif %}

<div class="info-box">
    <!-- FIXED: Dynamic form action based on whether we're creating or editing -->
    <form method="post" class="supplier-form" action="{% url 'supplier_edit' pk=form.instance.pk %}">
        {% csrf_token %}
        <button type="submit" class="btn-primary">Update Supplier</button>
        <a href="{% url 'supplier_list' %}" class="btn-secondary">Cancel</a>
            
        <h3 class="section-title">Personal Information</h3>
        
        {{ form.full_name.label_tag }}
        {{ form.full_name }}
        {% if form.full_name.errors %}
            <p class="error">{{ form.full_name.errors.0 }}</p>
        {% endif %}
        <br><br>

        {{ form.company_name.label_tag }}
        {{ form.company_name }}
        {% if form.company_name.errors %}
            <p class="error">{{ form.company_name.errors.0 }}</p>
        {% endif %}
        <br><br>

        {{ form.tax_id.label_tag }}
        {{ form.tax_id }}
        {% if form.tax_id.errors %}
            <p class="error">{{ form.tax_id.errors.0 }}</p>
        {% endif %}
        <br><br>

        <h3 class="section-title">Contact Information</h3>
        
        {{ form.email.label_tag }}
        {{ form.email }}
        {% if form.email.errors %}
            <p class="error">{{ form.email.errors.0 }}</p>
        {% endif %}
        <br><br>

        {{ form.phone.label_tag }}
        {{ form.phone }}
        {% if form.phone.errors %}
            <p class="error">{{ form.phone.errors.0 }}</p>
        {% endif %}
        <br><br>

        <h3 class="section-title">Location Information</h3>
        
        {{ form.address.label_tag }}
        {{ form.address }}
        {% if form.address.errors %}
            <p class="error">{{ form.address.errors.0 }}</p>
        {% endif %}
        <br><br>

        {{ form.zip_code.label_tag }}
        {{ form.zip_code }}
        {% if form.zip_code.errors %}
            <p class="error">{{ form.zip_code.errors.0 }}</p>
        {% endif %}
        <br><br>

        {{ form.province.label_tag }}
        {{ form.province }}
        {% if form.province.errors %}
            <p class="error">{{ form.province.errors.0 }}</p>
        {% endif %}
        <br><br>

        {{ form.location.label_tag }}
        {{ form.location }}
        {% if form.location.errors %}
            <p class="error">{{ form.location.errors.0 }}</p>
        {% endif %}
        <br><br>

        <h3 class="section-title">Business Information</h3>
        
        {{ form.production_activity.label_tag }}
        {{ form.production_activity }}
        {% if form.production_activity.errors %}
            <p class="error">{{ form.production_activity.errors.0 }}</p>
        {% endif %}
        <br><br>

        <div class="form-actions">
            <button type="submit" class="btn-primary">
                {% if form.instance.pk %}Update Supplier{% else %}Add Supplier{% endif %}
            </button>
            <a href="{% url 'supplier_list' %}" class="btn-secondary">Cancel</a>
        </div>
     </form>    
</div>
{% endblock %}